<?php
/***************************************************************************
 *   Copyright (C) by Stepanov Evgeny                                      *
 *   from.stev@gmail.com                                                   *
 ***************************************************************************
 * $Id: table.tpl.html 1546 2011-03-16 18:19:10Z stev $ */


/*
 * должны прийти:
 * - $_objects	(массив объектов)
 * - $_filter	(фильтр)
 * - $_name		(название таблицы)
 */

if (empty($_objects))
	throw new Exception("array 'objects' is empty");

$object = current($_objects);
$fields = $object->proto()->getPropertyList();

if ($_filter instanceof InterfaceFieldsFilter) {
	$fields	= $_filter->setAllFields($fields)->
		getList();
}

if (!$_widgetName)
	$_widgetName = strtolower($object->dao()->getObjectName());


// дальше отрисовка.
?>
	<table id="<?=$_widgetName?>" cellpadding="4" class="plain">
		<tr>
<?
foreach ($fields as $key => $type) { ?>
			<td>
				<b><?=_($key)?></b>
			</td>
<?}?>

		</tr>
<?
foreach ($_objects as $key => $object) { ?>
		<tr id="tr_<?=$object->getId()?>">
<?
	foreach ($fields as $key => $type) { ?>
			<td class="span">
				<?	$method = 'get'.ucfirst($key); ?>
				<?=	method_exists($object, $method)
					? GuiUtils::ObjectToString($object->{$method}())
					: '&nbsp;';
				?>
			</td>
<?	}
?>		</tr><?
}
?>
	</table>
